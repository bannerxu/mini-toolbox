# 项目架构说明

本文档详细介绍 Mini Toolbox 的系统架构、技术选型和设计模式。

## 🏗️ 整体架构

Mini Toolbox 采用**前后端分离**的架构模式：

```
┌─────────────────┐    HTTP/API    ┌─────────────────┐
│                 │ ────────────► │                 │
│   前端 (Vue 3)   │               │   后端 (Go)     │
│                 │ ◄──────────── │                 │
└─────────────────┘               └─────────────────┘
│                                 │
├─ Vite 开发服务器                ├─ HTTP API 服务器
├─ Vue Router 路由               ├─ 文件上传处理
├─ 组件化设计                    ├─ 静态文件服务
└─ 主题系统                      └─ CORS 跨域支持
```

## 🎯 设计原则

### 1. 模块化设计

- **组件化**: 每个功能都是独立的 Vue 组件
- **可扩展**: 新工具可以轻松添加到系统中
- **可复用**: 通用组件可在多个地方使用

### 2. 响应式优先

- **移动端优先**: 设计时优先考虑移动端体验
- **弹性布局**: 使用 CSS Grid 和 Flexbox
- **断点设计**: 适配不同屏幕尺寸

### 3. 用户体验

- **即时反馈**: 操作有立即的视觉反馈
- **渐进增强**: 基础功能不依赖后端
- **主题一致**: 统一的视觉设计语言

## 🛠️ 技术栈

### 前端技术栈

| 技术         | 版本     | 用途       |
|------------|--------|----------|
| Vue 3      | ^3.4.0 | 前端框架     |
| Vue Router | ^4.2.0 | 路由管理     |
| Vite       | ^5.0.0 | 构建工具     |
| Axios      | ^1.6.0 | HTTP 客户端 |

### 后端技术栈

| 技术   | 版本      | 用途      |
|------|---------|---------|
| Go   | >= 1.19 | 后端语言    |
| HTTP | 标准库     | Web 服务器 |

### 开发工具

| 工具           | 用途       |
|--------------|----------|
| Vite         | 开发服务器和构建 |
| Vue DevTools | 调试工具     |
| npm          | 包管理器     |

## 📁 前端架构详解

### 目录结构

```
frontend/
├── src/
│   ├── components/          # 可复用组件
│   │   ├── ImageUploader.vue    # 图片上传组件
│   │   ├── ToolCard.vue         # 工具卡片组件
│   │   └── ThemeSwitcher.vue    # 主题切换组件
│   ├── views/              # 页面组件
│   │   ├── Home.vue            # 首页
│   │   └── ImageUpload.vue     # 图片上传页面
│   ├── composables/        # 组合式函数
│   │   └── useTheme.js         # 主题管理
│   ├── router/             # 路由配置
│   │   └── index.js            # 路由定义
│   ├── App.vue             # 根组件
│   └── main.js             # 应用入口
├── index.html              # HTML 模板
├── vite.config.js          # Vite 配置
└── package.json            # 依赖和脚本
```

### 组件架构

#### 1. 页面组件 (Views)

- **Home.vue**: 首页，展示工具卡片网格
- **ImageUpload.vue**: 图片上传功能页面

#### 2. 功能组件 (Components)

- **ToolCard.vue**: 工具入口卡片，可配置图标、名称、描述
- **ImageUploader.vue**: 图片上传核心组件，支持拖拽
- **ThemeSwitcher.vue**: 主题切换界面组件

#### 3. 组合式函数 (Composables)

- **useTheme.js**: 主题管理逻辑，包括主题切换、本地存储、系统跟随

### 状态管理

采用 **Composition API** 进行状态管理：

```javascript
// 主题状态管理示例
const currentThemeId = ref('auto')
const currentTheme = computed(() => {
    // 主题计算逻辑
})
```

#### 状态存储策略

- **本地状态**: 使用 `ref` 和 `reactive`
- **持久化**: 关键设置存储到 `localStorage`
- **全局共享**: 通过 Composables 实现状态共享

### 路由设计

```javascript
const routes = [
    {
        path: '/',
        name: 'Home',
        component: Home,
        meta: {title: 'Mini Toolbox - 首页'}
    },
    {
        path: '/image-upload',
        name: 'ImageUpload',
        component: ImageUpload,
        meta: {title: 'Mini Toolbox - 图片上传'}
    }
]
```

#### 路由特性

- **嵌套路由**: 支持复杂页面结构
- **路由守卫**: 自动更新页面标题
- **懒加载**: 按需加载组件（未来扩展）

## 🎨 主题系统架构

### 主题数据结构

```javascript
const theme = {
    id: 'ocean',
    name: '海洋蓝',
    icon: '🌊',
    description: '清新的海洋蓝色主题',
    colors: {
        primary: '#667eea',
        secondary: '#1C1D1F',
        accent: '#409eff'
        // ... 更多颜色
    }
}
```

### CSS 变量系统

```css
:root {
    --theme-primary: #667eea;
    --theme-secondary: #1C1D1F;
    --theme-accent: #409eff;
}

.dark-theme {
    /* 深色主题变量覆盖 */
}
```

### 主题切换流程

1. 用户选择主题
2. 更新响应式状态
3. 应用 CSS 变量
4. 保存到 localStorage
5. 所有组件自动更新

## 🔄 数据流

### 前端数据流

```
用户操作 → 组件事件 → 状态更新 → 视图重渲染
                    ↓
              localStorage 持久化
```

### 前后端通信

```
前端组件 → Axios 请求 → Vite 代理 → Go 后端
                                      ↓
前端更新 ← 处理响应   ←  JSON 响应  ← 业务逻辑
```

## 🔧 构建和部署架构

### 开发环境

```
源码 → Vite Dev Server → 热重载 → 浏览器
             ↓
        ES 模块处理
        Vue SFC 编译
        CSS 预处理
```

### 生产构建

```
源码 → Vite Build → 优化处理 → 静态资源
           ↓
      代码分割
      资源压缩
      哈希命名
```

## 📊 性能优化策略

### 1. 加载优化

- **按需加载**: 路由级别的代码分割
- **资源预加载**: 关键资源优先加载
- **图片优化**: 支持多种图片格式

### 2. 运行时优化

- **虚拟 DOM**: Vue 3 优化的渲染性能
- **Composition API**: 更好的逻辑复用
- **CSS 变量**: 高效的主题切换

### 3. 缓存策略

- **浏览器缓存**: 合理的缓存头设置
- **本地存储**: 用户偏好设置缓存
- **CDN 分发**: 静态资源加速（可选）

## 🛡️ 安全考虑

### 前端安全

- **输入验证**: 文件类型和大小检查
- **XSS 防护**: Vue 模板自动转义
- **HTTPS**: 生产环境强制 HTTPS

### 后端安全

- **文件上传**: 类型限制和大小控制
- **CORS 配置**: 跨域请求控制
- **路径遍历**: 防止目录遍历攻击

## 🔮 扩展性设计

### 新工具接入

1. 创建工具组件
2. 添加路由配置
3. 更新工具列表
4. 可选：添加后端 API

### 主题扩展

1. 定义主题配置
2. 添加到主题列表
3. 自动支持所有组件

### 国际化准备

- 组件设计支持多语言
- 文本外部化配置
- 日期、数字格式化

---

📋 **设计文档**: 这个架构支持项目的持续发展和功能扩展，同时保持代码的可维护性。